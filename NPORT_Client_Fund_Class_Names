EXEC sp_set_session_context @key=N'SystemUserName', @value='SYSTEM'

SELECT
DISTINCT

--CLIENT
cl.Name as ClientName
,cl.ClientCode as ClientCode
,cl.ClientID as ClientID

--COMPLEX
,cx.Name as ComplexName
,cx.ComplexCode as ComplexCode

--FUND GROUP
,fg.Name as FundGroupName
,fg.FundGroupCode as FundGroupCode

--FUND
,fnd.Name as FundName
,fnd.FundCode

--CLASS
--,fc.Name as ClassName
--,fc.FundClassCode

--FUND CREATED DATE
,CAST(fnd.CreatedDateTime as date) as date_created
,CAST(fnd.CreatedDateTime as time(0)) as time_created


FROM dbo.Client as cl
JOIN dbo.Complex as cx on cl.ClientID = cx.ClientID
JOIN dbo.FundGroup as fg on cx.ComplexID = fg.ComplexID
JOIN dbo.Fund as fnd on fg.FundGroupID = fnd.FundGroupID
--JOIN dbo.FundClass as fc on cx.ComplexID = fc.ComplexID

WHERE fnd.IsActive = 1
